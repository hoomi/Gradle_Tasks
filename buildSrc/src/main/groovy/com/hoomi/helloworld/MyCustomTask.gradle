import org.gradle.api.DefaultTask
import org.gradle.api.TaskAction

class MySqlTask extends DefaultTask {
    def sql
    def fileName = "test.db"
    def openDatabase
    def username = 'root'
    def password = 'password'
    def database
    def port = 3306
    def host = 'localhost'

    @TaskAction
    def runQuery() {
        def cmd 
        // if (database) {
        //     cmd = "mysql -u ${username} -p ${password} -h ${host} -P ${port}  ${database}  -e"
        // } else {
        //     cmd = "mysql -u ${username} -p ${password} -h ${host} -P ${port} -e"
        // }
        if (openDatabase) {
            cmd = "sqlite3 ${fileName}"
        } else {
            cmd = "sqlite3 ${fileName} -cmd ${sql}"
        }
        logger.info "cmd is: ${cmd}"
        project.exec {
            commandLine = cmd.split().toList() + sql
        }
    }
}